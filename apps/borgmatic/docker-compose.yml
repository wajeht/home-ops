services:
  borgmatic:
    image: ghcr.io/borgmatic-collective/borgmatic
    env_file:
      - .env
    environment:
      - TZ=America/Chicago
    volumes:
      - /home/jaw/data:/source/data:ro
      - /home/jaw/.sops:/source/sops:ro
      - /home/jaw/backup/borg:/repository
      - /home/jaw/data/borgmatic:/borgmatic/state
      - ./config.yml:/etc/borgmatic/config.yaml:ro
      - ./crontab.txt:/etc/borgmatic.d/crontab.txt:ro
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 1G
