{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":semanticCommits"
  ],
  "docker-compose": {
    "fileMatch": [
      "(^|/)docker-compose\\.ya?ml$",
      "apps/.+/docker-compose\\.ya?ml$",
      "infra/.+/docker-compose\\.ya?ml$"
    ]
  },
  "hostRules": [
    {
      "matchHost": "ghcr.io",
      "hostType": "docker",
      "token": "{{ secrets.GHCR_TOKEN }}"
    }
  ],
  "packageRules": [
    {
      "description": "Auto-merge own ghcr images",
      "matchDatasources": ["docker"],
      "matchPackagePatterns": ["^ghcr\\.io/wajeht/"],
      "automerge": true,
      "automergeType": "branch",
      "ignoreTests": true
    },
    {
      "description": "Third-party images - PR only",
      "matchDatasources": ["docker"],
      "excludePackagePatterns": ["^ghcr\\.io/wajeht/"],
      "automerge": false
    }
  ]
}
